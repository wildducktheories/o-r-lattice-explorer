# Affine Block Structure in Collatz Sequences

This work studies Collatz sequences using **affine block structures**, which organize integers into families sharing predictable parity patterns.

## Block Parameters

Each block is defined by: `B = (α, ν, ρ, κ)`

- **α** ≥ 1 - 2-adic valuation v₂(x/2^ν + 1) of the odd core plus one
- **ν** ≥ 0 - counts trailing 2's in x (v₂(x))
- **ρ** ≥ 1 - odd integer parameter defining the block structure
- **κ** ≥ α - block length (number of even steps)
- **t** ≥ 0 - scaling parameter enumerating different x values sharing the same block structure

## The Fundamental Identity

The framework is built on this identity:

```
x + 1 = 2^ν · 2^α · (ρ + t·2^(κ-α))
```

This identity captures the essential affine structure without requiring internal 3-adic dynamics.

## Affine Functions

Each block defines two affine functions mapping t to values:

### The x-Function

Maps the scaling parameter to integers within the block:

```
x(B,t) = 2^ν · (2^α · (ρ + t·2^(κ-α)) - 1)

Slope: m_x = 2^(ν+κ)
Intercept: c_x = 2^ν · (2^α·ρ - 1)
```

### The Successor Function

Gives the starting value of the successor block:

```
succ_x(B,t) = (3^α·ρ - 1)/2^(κ-α) + 3^α·t

Slope: m_succ = 3^α
Intercept: c_succ = (3^α·ρ - 1)/2^(κ-α)
```

## Computing Block Parameters

Given an integer x, compute its block parameters:

1. Compute ν = v₂(x), the 2-adic valuation
2. Extract the odd core: x_odd = x / 2^ν
3. Compute α = v₂(x_odd + 1)
4. Compute m_raw = (x_odd + 1) / 2^α
5. For natural blocks, compute β = v₂(3^α·m_raw - 1) and set κ = α + β
6. For basic blocks, choose κ ∈ [α, α + β]
7. Compute ρ = m_raw mod 2^(κ-α)
8. Compute the scaling parameter: t = ⌊(m_raw - ρ)/2^(κ-α)⌋

**Note:** ρ must be odd. If the computed value is even, there is an error in the calculation.

## Natural Blocks vs Basic Blocks

- **Natural blocks**: κ = α + β, where β = v₂(3^α·m_raw - 1)
- **Basic blocks**: κ ∈ [α, α + β] (generalized blocks with arbitrary length)

Natural blocks represent the "default" block structure determined entirely by α and the initial value.

## Example: x = 35

For x = 35:
```
ν = v₂(35) = 0 (odd number)
α = v₂(36) = 2
m_raw = 36/4 = 9
β = v₂(3²·9 - 1) = v₂(80) = 4
κ = 2 + 4 = 6 (natural block)
ρ = 9 mod 16 = 9
t = ⌊(9-9)/16⌋ = 0
```

Block parameters: `B = (α=2, ν=0, ρ=9, κ=6)`, t=0

The affine functions are:
```
x(t) = 2⁰·(2²·(9 + t·2⁴) - 1) = 4(9 + 16t) - 1 = 64t + 35
succ_x(t) = (3²·9 - 1)/2⁴ + 3²·t = 80/16 + 9t = 5 + 9t
```

For t = 0: x(0) = 35 and succ_x(0) = 5.

Indeed, the Collatz sequence from x = 35 gives: 35 → 106 → 53 → 160 → 80 → 40 → 20 → 10 → 5, confirming that the successor block starts at 5.

## Why This Matters

- **Affine structure**: Blocks naturally organize into affine families, revealing geometric patterns in Collatz sequences
- **Minimal parameterization**: Using only 4 parameters plus t, we capture the essential structure without internal dynamics
- **Lattice-wide relationships**: The successor function connects blocks across the entire trajectory
- **Computational efficiency**: Block parameters can be computed directly from x without iterating the sequence

## Scope and Limitations

This framework intentionally focuses on **lattice-wide affine relationships** between blocks as atomic units. It does not attempt to model:

- Internal evolution of individual blocks through the Collatz map
- 3-adic structure within blocks (powers of 3 in intermediate values)
- Step-by-step parity patterns within blocks

These aspects of internal block dynamics, if needed, should be treated separately in an independent analysis.

## History

### January 2026 - Simplified to 4 Parameters

**Previous approach (WITHDRAWN):** Used 6 parameters (α, δ, ν, γ, ρ, κ) in an attempt to capture both internal block dynamics and lattice-wide relationships simultaneously.

**Problem:** The γ and δ parameters (representing 3-adic valuations) conflated two distinct aspects:
1. Internal dynamics of blocks (how blocks evolve through the Collatz map)
2. Lattice-wide dynamics (how blocks relate to each other as whole units)

This conflation caused instability and conceptual muddling.

**Solution:** The current 4-parameter approach (α, ν, ρ, κ) focuses exclusively on lattice-wide affine relationships, eliminating the 3-adic parameters entirely. The fundamental identity x+1 = 2^ν·2^α·(ρ + t·2^(κ-α)) captures all necessary structure without requiring internal 3-adic analysis.

---

**See the paper:** papers/affine-block-structures.pdf for full mathematical details.
